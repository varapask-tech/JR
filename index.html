
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)</title>
  <style>
    body { font-family: sans-serif; background: #f8f9fa; padding: 2rem; }
    .box { max-width: 800px; margin: auto; background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); }
    h2 { text-align: center; color: #2c3e50; }
    textarea, select, button { width: 100%; font-size: 1rem; margin: 0.5rem 0; padding: 0.75rem; border-radius: 6px; border: 1px solid #ccc; }
    button { cursor: pointer; border: none; }
    .btn-green { background: #27ae60; color: white; }
    .btn-red { background: #c0392b; color: white; }
    .btn-blue { background: #2980b9; color: white; }
    pre { background: #f1f2f6; padding: 1rem; white-space: pre-wrap; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="box">
    <h2>üì¶ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡∏ï/‡πÅ‡∏Ç‡∏ß‡∏á + ‡∏•‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</h2>
    <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
    <select id="productLine">
      <option>‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 1 ‡πÅ‡∏ñ‡∏° 2 / 50ml. / 1 / 0</option>
      <option>‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 2 ‡πÅ‡∏ñ‡∏° 4 / 50ml. / 1 / 0</option>
      <option>‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î Dr.YuTitan 3 ‡πÅ‡∏ñ‡∏° 6 / 50ml. / 1 / 0</option>
      <option>Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 1 ‡πÅ‡∏ñ‡∏° 1 / 100ml. / 1 / 0</option>
      <option>Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 2 ‡πÅ‡∏ñ‡∏° 2 / 100ml. / 1 / 0</option>
      <option>Kreain Nature ‡πÄ‡∏à‡∏•‡∏ô‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î 3 ‡πÅ‡∏ñ‡∏° 3 / 100ml. / 1 / 0</option>
    </select>

    <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à:</label>
    <select id="pageLine">
      <option>Kreain Nature ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡∏Ç‡πâ‡∏≠</option>
      <option>‡πÄ‡∏à‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏ß‡∏î‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á Dr.YuTitan</option>
    </select>

    <label>‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</label>
    <textarea id="inputText" rows="10" placeholder="‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>

    <button class="btn-green" onclick="transformText()">‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
    <button class="btn-red" onclick="resetForm()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

    <pre id="outputText">üìã ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ...</pre>
    <button class="btn-blue" onclick="copyOutput()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
  </div>

  <script>
    function transformText() {
      const lines = document.getElementById("inputText").value.trim().split("\n");
      const filteredLines = lines.filter(l => !l.includes("üìå ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Ç‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏ô‡∏∞‡∏Ñ‡∏∞"));
      const product = document.getElementById("productLine").value;
      const page = document.getElementById("pageLine").value;
      const today = new Date().toISOString().split("T")[0];
      let output = [];

      const code = filteredLines[0]?.trim();
      const name = filteredLines[1]?.trim();
      output.push(`=${code}.${name}`);
      output.push(`=${product}`);

      const cod = filteredLines.find(l => l.toLowerCase().includes("cod"))?.split(":")[1]?.trim() || "";
      output.push(`=COD/${cod}`);

      const fb = filteredLines.find(l => l.toLowerCase().includes("fb:"))?.split(":")[1]?.trim() || "";
      const pg = filteredLines.find(l => l.toLowerCase().includes("pg:"))?.split(":")[1]?.trim() || "";
      const admin = filteredLines.find(l => l.toLowerCase().includes("admin:"))?.split(":")[1]?.trim() || "";
      const phone = filteredLines.find(l => /^0[689]\d{8}$/.test(l)) || "";

      const zipLine = filteredLines.find(l => /\d{5}/.test(l)) || "";
      
    
    let zip = "";
    const zipCandidates = filteredLines.filter(l => /\b\d{5}\b/.test(l));
    if (zipCandidates.length > 0) {
      zip = zipCandidates[0].match(/\b\d{5}\b/)[0];
    }
    
    if (zipLine.match(/\d{5}/)) {
      zip = zipLine.match(/\d{5}/)[0];
    } else {
      const guessZip = filteredLines.find(l => /\d{5}/.test(l));
      if (guessZip) zip = guessZip.match(/\d{5}/)[0];
    }
    
      
    let province = "";
    if (zipLine.includes("‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û") || filteredLines.some(l => l.includes("‡πÄ‡∏Ç‡∏ï") || l.includes("‡πÅ‡∏Ç‡∏ß‡∏á"))) {
      province = "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£";
    } else {
      const matchProv = zipLine.match(/‡∏à\.\s*(\S+)/);
      if (matchProv) province = matchProv[1];
    }
    

      const khwaeng = filteredLines.find(l => l.includes("‡πÅ‡∏Ç‡∏ß‡∏á")) || "";
      const khet = filteredLines.find(l => l.includes("‡πÄ‡∏Ç‡∏ï")) || "";
      const tambon = filteredLines.find(l => l.includes("‡∏ï.")) || "";
      const amphur = filteredLines.find(l => l.includes("‡∏≠.")) || "";
      const addressLines = filteredLines.filter(l => !l.startsWith(code) && !l.startsWith(name) && !l.includes("COD") && !l.includes("Fb") && !l.includes("Pg") && !l.includes("Admin") && !/^0[689]/.test(l) && !/\d{5}/.test(l) && !l.includes("‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î"));

      let fullAddress = addressLines.join(" ");
      
    if (province === "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£") {
        if (!khwaeng.includes("‡πÅ‡∏Ç‡∏ß‡∏á")) khwaeng = "‡πÅ‡∏Ç‡∏ß‡∏á" + khwaeng;
        if (!khet.includes("‡πÄ‡∏Ç‡∏ï")) khet = "‡πÄ‡∏Ç‡∏ï" + khet;
    
        fullAddress += ` ${khwaeng} ,${khet}`;
      } else {
        
    if (!tambon.includes("‡∏ï.")) tambon = "‡∏ï." + tambon;
    if (!amphur.includes("‡∏≠.")) amphur = "‡∏≠." + amphur;
    fullAddress += ` ${tambon} ,${amphur}`;
    
      }

      output.push("=" + fullAddress.trim());
      output.push("=" + province);
      output.push("=" + zip);
      output.push("=" + phone);
      output.push("=" + fb);
      output.push("=" + admin);
      output.push("=" + page);
      output.push("=" + today);

      document.getElementById("outputText").textContent = output.join("\n");
    }

    function resetForm() {
      document.getElementById("inputText").value = "";
      document.getElementById("outputText").textContent = "üìã ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ...";
    }

    function copyOutput() {
      const text = document.getElementById("outputText").textContent;
      navigator.clipboard.writeText(text).then(() => alert("‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏•‡πâ‡∏ß!"));
    }
  </script>
</body>
</html>
